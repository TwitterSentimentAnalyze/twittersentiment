<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 Interactive component | Twitter Sentiment Analysis</title>
  <meta name="description" content="Chapter 6 Interactive component | Twitter Sentiment Analysis" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 Interactive component | Twitter Sentiment Analysis" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Interactive component | Twitter Sentiment Analysis" />
  
  
  

<meta name="author" content="Sung Jun Won(sw3049), Elin Kim(hk3175), Alex Kita(ak4729)" />


<meta name="date" content="2021-12-11" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="results.html"/>
<link rel="next" href="conclusion.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">TS</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="data-sources.html"><a href="data-sources.html"><i class="fa fa-check"></i><b>2</b> Data sources</a>
<ul>
<li class="chapter" data-level="2.1" data-path="data-sources.html"><a href="data-sources.html#politicians"><i class="fa fa-check"></i><b>2.1</b> Politicians</a></li>
<li class="chapter" data-level="2.2" data-path="data-sources.html"><a href="data-sources.html#medical-associations"><i class="fa fa-check"></i><b>2.2</b> Medical Associations</a></li>
<li class="chapter" data-level="2.3" data-path="data-sources.html"><a href="data-sources.html#celebrities"><i class="fa fa-check"></i><b>2.3</b> Celebrities</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-transformation.html"><a href="data-transformation.html"><i class="fa fa-check"></i><b>3</b> Data transformation</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data-transformation.html"><a href="data-transformation.html#functions-for-data-cleaning"><i class="fa fa-check"></i><b>3.1</b> Functions for data cleaning</a></li>
<li class="chapter" data-level="3.2" data-path="data-transformation.html"><a href="data-transformation.html#cleaning-process"><i class="fa fa-check"></i><b>3.2</b> Cleaning process</a></li>
<li class="chapter" data-level="3.3" data-path="data-transformation.html"><a href="data-transformation.html#combining-all-three-groups-with-indicator-column"><i class="fa fa-check"></i><b>3.3</b> Combining all three groups with indicator column</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="missing-values.html"><a href="missing-values.html"><i class="fa fa-check"></i><b>4</b> Missing values</a></li>
<li class="chapter" data-level="5" data-path="results.html"><a href="results.html"><i class="fa fa-check"></i><b>5</b> Results</a>
<ul>
<li class="chapter" data-level="5.1" data-path="results.html"><a href="results.html#data-exploration"><i class="fa fa-check"></i><b>5.1</b> Data Exploration</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="results.html"><a href="results.html#the-number-of-tweets-for-different-groups"><i class="fa fa-check"></i><b>5.1.1</b> The Number of Tweets for Different Groups</a></li>
<li class="chapter" data-level="5.1.2" data-path="results.html"><a href="results.html#the-number-of-followers-for-different-groups"><i class="fa fa-check"></i><b>5.1.2</b> The Number of Followers for Different Groups</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="results.html"><a href="results.html#what-were-the-sentimental-reactions-of-different-groups-to-covid-19-news"><i class="fa fa-check"></i><b>5.2</b> What were the sentimental reactions of different groups to Covid-19 news?</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="results.html"><a href="results.html#the-transitions-of-sentiments-positivenegative-for-different-groups"><i class="fa fa-check"></i><b>5.2.1</b> The Transitions of Sentiments (Positive/Negative) for Different Groups</a></li>
<li class="chapter" data-level="5.2.2" data-path="results.html"><a href="results.html#mosaic-plot"><i class="fa fa-check"></i><b>5.2.2</b> Mosaic Plot</a></li>
<li class="chapter" data-level="5.2.3" data-path="results.html"><a href="results.html#alluvial-diagram"><i class="fa fa-check"></i><b>5.2.3</b> Alluvial Diagram</a></li>
<li class="chapter" data-level="5.2.4" data-path="results.html"><a href="results.html#stacked-barplot"><i class="fa fa-check"></i><b>5.2.4</b> Stacked Barplot</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="results.html"><a href="results.html#deep-dive-into-reactions-of-politicians-and-news-media"><i class="fa fa-check"></i><b>5.3</b> Deep dive into reactions of politicians and news media:</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="results.html"><a href="results.html#transition-of-sentiments-for-different-political-parties"><i class="fa fa-check"></i><b>5.3.1</b> Transition of Sentiments for Different Political Parties</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="results.html"><a href="results.html#deep-dive-into-correlations-of-key-metrics-and-sentiments"><i class="fa fa-check"></i><b>5.4</b> Deep dive into correlations of key metrics and sentiments:</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="interactive-component.html"><a href="interactive-component.html"><i class="fa fa-check"></i><b>6</b> Interactive component</a></li>
<li class="chapter" data-level="7" data-path="conclusion.html"><a href="conclusion.html"><i class="fa fa-check"></i><b>7</b> Conclusion</a></li>
<li class="chapter" data-level="8" data-path="missing-values-1.html"><a href="missing-values-1.html"><i class="fa fa-check"></i><b>8</b> Missing values</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Twitter Sentiment Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="interactive-component" class="section level1" number="6">
<h1><span class="header-section-number">Chapter 6</span> Interactive component</h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="interactive-component.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="interactive-component.html#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb1-3"><a href="interactive-component.html#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggnewscale)</span>
<span id="cb1-4"><a href="interactive-component.html#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rtweet)</span>
<span id="cb1-5"><a href="interactive-component.html#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sjmisc)</span>
<span id="cb1-6"><a href="interactive-component.html#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb1-7"><a href="interactive-component.html#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(base)</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="interactive-component.html#cb2-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;./resources/data_combined_filtered_sentiment.csv&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="interactive-component.html#cb3-1" aria-hidden="true" tabindex="-1"></a>df_t <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">select</span>(created_at, group, sentiment_score)</span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="interactive-component.html#cb4-1" aria-hidden="true" tabindex="-1"></a>times <span class="ot">&lt;-</span> <span class="fu">as.character</span>(df_t<span class="sc">$</span>created_at)</span>
<span id="cb4-2"><a href="interactive-component.html#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="interactive-component.html#cb4-3" aria-hidden="true" tabindex="-1"></a>dates <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb4-4"><a href="interactive-component.html#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="interactive-component.html#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (time <span class="cf">in</span> times){</span>
<span id="cb4-6"><a href="interactive-component.html#cb4-6" aria-hidden="true" tabindex="-1"></a>  date <span class="ot">&lt;-</span> <span class="fu">strsplit</span>(time, <span class="st">&quot; +&quot;</span>)[[<span class="dv">1</span>]][<span class="dv">1</span>]</span>
<span id="cb4-7"><a href="interactive-component.html#cb4-7" aria-hidden="true" tabindex="-1"></a>  dates <span class="ot">&lt;-</span> <span class="fu">c</span>(dates, date)</span>
<span id="cb4-8"><a href="interactive-component.html#cb4-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-9"><a href="interactive-component.html#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="interactive-component.html#cb4-10" aria-hidden="true" tabindex="-1"></a>df_t<span class="sc">$</span>created_at <span class="ot">&lt;-</span> dates</span>
<span id="cb4-11"><a href="interactive-component.html#cb4-11" aria-hidden="true" tabindex="-1"></a>df_t</span></code></pre></div>
<pre><code>## # A tibble: 11,088 × 3
##    created_at group       sentiment_score
##    &lt;chr&gt;      &lt;chr&gt;                 &lt;dbl&gt;
##  1 2021-11-22 celebrities           1    
##  2 2021-11-22 celebrities           1    
##  3 2021-11-22 celebrities           1    
##  4 2021-11-13 celebrities           0.333
##  5 2021-10-15 celebrities           0.333
##  6 2021-10-07 celebrities           1    
##  7 2021-09-24 celebrities           0.333
##  8 2020-05-10 celebrities           0    
##  9 2021-11-19 celebrities           1    
## 10 2021-11-19 celebrities           0.6  
## # … with 11,078 more rows</code></pre>
<p>We made two csv files for interactive graph. Both csv contain four columns - date, politicians’ sentiment scores, medicals’ sentiment scores, celebrities’ sentiment scores. interactive_with_na.csv contains all dates that at least one of the groups has sentiment scores, which means there are NAs in some entries for each group. interactive_without_na.csv only contains dates that all three groups have sentiment scores.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="interactive-component.html#cb6-1" aria-hidden="true" tabindex="-1"></a>df_p <span class="ot">&lt;-</span> df_t <span class="sc">%&gt;%</span> <span class="fu">filter</span>(group <span class="sc">==</span> <span class="st">&quot;politicians&quot;</span>) </span>
<span id="cb6-2"><a href="interactive-component.html#cb6-2" aria-hidden="true" tabindex="-1"></a>df_m <span class="ot">&lt;-</span> df_t <span class="sc">%&gt;%</span> <span class="fu">filter</span>(group <span class="sc">==</span> <span class="st">&quot;medical&quot;</span>)</span>
<span id="cb6-3"><a href="interactive-component.html#cb6-3" aria-hidden="true" tabindex="-1"></a>df_c <span class="ot">&lt;-</span> df_t <span class="sc">%&gt;%</span> <span class="fu">filter</span>(group <span class="sc">==</span> <span class="st">&quot;celebrities&quot;</span>)</span>
<span id="cb6-4"><a href="interactive-component.html#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="interactive-component.html#cb6-5" aria-hidden="true" tabindex="-1"></a>df_p <span class="ot">&lt;-</span> df_p <span class="sc">%&gt;%</span></span>
<span id="cb6-6"><a href="interactive-component.html#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(created_at) <span class="sc">%&gt;%</span></span>
<span id="cb6-7"><a href="interactive-component.html#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">sentiment_score =</span> <span class="fu">mean</span>(sentiment_score))</span>
<span id="cb6-8"><a href="interactive-component.html#cb6-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-9"><a href="interactive-component.html#cb6-9" aria-hidden="true" tabindex="-1"></a>df_m <span class="ot">&lt;-</span> df_m <span class="sc">%&gt;%</span></span>
<span id="cb6-10"><a href="interactive-component.html#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(created_at) <span class="sc">%&gt;%</span></span>
<span id="cb6-11"><a href="interactive-component.html#cb6-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">sentiment_score =</span> <span class="fu">mean</span>(sentiment_score))</span>
<span id="cb6-12"><a href="interactive-component.html#cb6-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-13"><a href="interactive-component.html#cb6-13" aria-hidden="true" tabindex="-1"></a>df_c <span class="ot">&lt;-</span> df_c <span class="sc">%&gt;%</span></span>
<span id="cb6-14"><a href="interactive-component.html#cb6-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(created_at) <span class="sc">%&gt;%</span></span>
<span id="cb6-15"><a href="interactive-component.html#cb6-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">sentiment_score =</span> <span class="fu">mean</span>(sentiment_score))</span>
<span id="cb6-16"><a href="interactive-component.html#cb6-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-17"><a href="interactive-component.html#cb6-17" aria-hidden="true" tabindex="-1"></a>df_combined <span class="ot">&lt;-</span> <span class="fu">merge</span>(df_p, df_m, <span class="at">by =</span> <span class="st">&quot;created_at&quot;</span>)</span>
<span id="cb6-18"><a href="interactive-component.html#cb6-18" aria-hidden="true" tabindex="-1"></a>df_combined <span class="ot">&lt;-</span> <span class="fu">merge</span>(df_combined, df_c, <span class="at">by =</span> <span class="st">&quot;created_at&quot;</span>)</span>
<span id="cb6-19"><a href="interactive-component.html#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df_combined) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;x&#39;</span>, <span class="st">&#39;politicians&#39;</span>, <span class="st">&#39;medicals&#39;</span>, <span class="st">&#39;celebrities&#39;</span>)</span>
<span id="cb6-20"><a href="interactive-component.html#cb6-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-21"><a href="interactive-component.html#cb6-21" aria-hidden="true" tabindex="-1"></a>df_combined_na <span class="ot">&lt;-</span> <span class="fu">merge</span>(df_p, df_m, <span class="at">by =</span> <span class="st">&quot;created_at&quot;</span>, <span class="at">all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb6-22"><a href="interactive-component.html#cb6-22" aria-hidden="true" tabindex="-1"></a>df_combined_na <span class="ot">&lt;-</span> <span class="fu">merge</span>(df_combined_na, df_c, <span class="at">by =</span> <span class="st">&quot;created_at&quot;</span>, <span class="at">all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb6-23"><a href="interactive-component.html#cb6-23" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df_combined_na) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;x&#39;</span>, <span class="st">&#39;politicians&#39;</span>, <span class="st">&#39;medicals&#39;</span>, <span class="st">&#39;celebrities&#39;</span>)</span>
<span id="cb6-24"><a href="interactive-component.html#cb6-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-25"><a href="interactive-component.html#cb6-25" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(df_combined_na, <span class="st">&quot;./resources/interactive_with_na.csv&quot;</span>)</span>
<span id="cb6-26"><a href="interactive-component.html#cb6-26" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(df_combined, <span class="st">&quot;./resources/interactive_without_na.csv&quot;</span>)</span></code></pre></div>
<p>We decided to use interactive_without_na.csv because having NAs in the dataset made the interactive graph malfunction when transitioning to another group. We made an interactive graph. Using the drop-down button at top left, we can choose which group’s sentiment score graph over time to display. We smoothed the curve (because there are many missing dates in the dataframe) by using d3 built-in function, d3.curveBasis. The graph will start by showing politicians’ sentiment score graph by default, and choosing another group from the button will transform the graph accordingly. The benefit of using this interactive graph is that we can see each group’s sentiment score changes more closely, and also, we can tell the difference between two groups by seeing how the graph transforms as we choose another group from the button.</p>
<p>And as we can see from the graph, sentiment score of celebrities move in the similar direction as the medicals’ score. One can go back and forth between the two groups’ graphs to see that the general flow of the graphs don’t change much, although the celebrities’ scores are fluctuating more. But the politicians’ score move in the opposite direction of the medical’s score. One can go back and forth between the two groups’ graphs to see that the general flow of the graphs change dramatically.</p>
<p>&lt;&lt;insertHTML:[test.html]</p>
<!DOCTYPE html>
<html>
<meta charset="utf-8">
  
<head>
  <script src="https://unpkg.com/d3-regression@1.3.9/dist/d3-regression.min.js"></script>
  <script src="https://d3js.org/d3.v7.js"></script>
</head>
  
<body>
    <h1 style="text-align:center; color:green;">
        Sentiment Transition
    </h1>
    <center>
      <select id="selectButton"></select>
    </center>

    <center>
        <svg id="gfg" width="600" height="400"></svg>
    </center>
      
    <script>
        var svg = d3.select("svg#gfg")
        var margin = {top: 20, right: 50, bottom: 30, left: 50}
        var width =  +svg.attr("width") - margin.left - margin.right
        var height = +svg.attr("height") - margin.top - margin.bottom
        var g = svg.append("g").attr("transform", `translate(${margin.left}, ${margin.top})`);
        var parseTime = d3.timeParse("%Y-%m-%d");

  
        var xScale = d3.scaleTime().range([0, width]);
        var yScale = d3.scaleLinear()
            .domain([-0.2, 0.9]).range([height, 0]);

        var xAxis = d3.axisBottom()
                      .scale(xScale)
                      .tickFormat(d3.timeFormat("%Y-%m-%d"));

        var allGroup = ["politicians", "medicals", "celebrities"] 
        d3.select("#selectButton")
          .selectAll('myOptions')
          .data(allGroup)
          .enter()
          .append('option')
          .text(function (d) { return d; }) // text showed in the menu
          .attr("value", function (d) { return d; }) // corresponding value returned by the button
        
        var myColor = d3.scaleOrdinal()
          .domain(allGroup)
          .range(d3.schemeCategory10);

        d3.csv("https://raw.githubusercontent.com/TwitterSentimentAnalyze/twittersentiment/share2/resources/interactive_without_na.csv").then(function(data) {
          

          data.forEach(function(d) {
            d.x = parseTime(d.x);
            console.log(d.x)
          });
        var temp = data.map(function(d){return {time: d.x, value:d["politicians"]} })
        
        var regressionGenerator = d3.regressionLoess()
              .x(d => d.time)
              .y(d => d.value)
              .bandwidth(.4);
        var line = d3.line()
            .x((d) => xScale(d[0]))
            .y((d) => yScale(d[1]))
            .curve(d3.curveBundle.beta(0.9));
        
        xScale
        .domain(d3.extent(temp, d => d.time));
  
        g.append("g")
          .attr("transform", `translate(0, ${height})`)
          .call(xAxis);
      
        g.append("g")
          .call(d3.axisLeft(yScale))
        g.append("path")
          .datum(regressionGenerator(temp))
          .attr("d", line)
          .attr("class", "line")
          .attr("id", "line")
          .attr("fill", "none")
          .attr("stroke", myColor("politicians"));
        function update(selectedGroup) {
          var dataFilter = data.map(function(d){return {time: d.x, value:d[selectedGroup]} })
          var path = svg.selectAll('path#line')
          path
            .datum(regressionGenerator(dataFilter))
            .transition()
            .duration(1000)
            .attr("d", line)
            .attr("stroke", function(d){ return myColor(selectedGroup) })
        }

        d3.select("#selectButton").on("change", function(d) {
          var selectedOption = d3.select(this).property("value")
          update(selectedOption)
        })
      })
        
    </script>
</body>
  
</html>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="results.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="conclusion.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/twittersentimentanalyze/twittersentiment/edit/main/06-interactive.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/twittersentimentanalyze/twittersentiment/blob/main/06-interactive.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
