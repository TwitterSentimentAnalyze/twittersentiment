<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Missing values | Twitter Sentiment Analysis</title>
  <meta name="description" content="Chapter 4 Missing values | Twitter Sentiment Analysis" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Missing values | Twitter Sentiment Analysis" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Missing values | Twitter Sentiment Analysis" />
  
  
  

<meta name="author" content="Sung Jun Won(sw3049), Elin Kim(hk3175), Alex Kita(ak4729)" />


<meta name="date" content="2021-12-11" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data-transformation.html"/>
<link rel="next" href="results.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">TS</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="data-sources.html"><a href="data-sources.html"><i class="fa fa-check"></i><b>2</b> Data sources</a>
<ul>
<li class="chapter" data-level="2.1" data-path="data-sources.html"><a href="data-sources.html#politicians"><i class="fa fa-check"></i><b>2.1</b> Politicians</a></li>
<li class="chapter" data-level="2.2" data-path="data-sources.html"><a href="data-sources.html#medical-associations"><i class="fa fa-check"></i><b>2.2</b> Medical Associations</a></li>
<li class="chapter" data-level="2.3" data-path="data-sources.html"><a href="data-sources.html#celebrities"><i class="fa fa-check"></i><b>2.3</b> Celebrities</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-transformation.html"><a href="data-transformation.html"><i class="fa fa-check"></i><b>3</b> Data transformation</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data-transformation.html"><a href="data-transformation.html#functions-for-data-cleaning"><i class="fa fa-check"></i><b>3.1</b> Functions for data cleaning</a></li>
<li class="chapter" data-level="3.2" data-path="data-transformation.html"><a href="data-transformation.html#cleaning-process"><i class="fa fa-check"></i><b>3.2</b> Cleaning process</a></li>
<li class="chapter" data-level="3.3" data-path="data-transformation.html"><a href="data-transformation.html#combining-all-three-groups-with-indicator-column"><i class="fa fa-check"></i><b>3.3</b> Combining all three groups with indicator column</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="missing-values.html"><a href="missing-values.html"><i class="fa fa-check"></i><b>4</b> Missing values</a></li>
<li class="chapter" data-level="5" data-path="results.html"><a href="results.html"><i class="fa fa-check"></i><b>5</b> Results</a>
<ul>
<li class="chapter" data-level="5.1" data-path="results.html"><a href="results.html#data-exploration"><i class="fa fa-check"></i><b>5.1</b> Data Exploration</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="results.html"><a href="results.html#the-number-of-covid-19-related-tweets-for-different-groups"><i class="fa fa-check"></i><b>5.1.1</b> The Number of Covid-19-related Tweets for Different Groups</a></li>
<li class="chapter" data-level="5.1.2" data-path="results.html"><a href="results.html#the-number-of-followers-for-different-groups"><i class="fa fa-check"></i><b>5.1.2</b> The Number of Followers for Different Groups</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="results.html"><a href="results.html#what-were-the-sentimental-reactions-of-different-groups-to-covid-19-news"><i class="fa fa-check"></i><b>5.2</b> What were the sentimental reactions of different groups to Covid-19 news?</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="results.html"><a href="results.html#the-change-of-sentiments-positivenegative-for-different-groups"><i class="fa fa-check"></i><b>5.2.1</b> The Change of Sentiments (Positive/Negative) for Different Groups</a></li>
<li class="chapter" data-level="5.2.2" data-path="results.html"><a href="results.html#mosaic-plot"><i class="fa fa-check"></i><b>5.2.2</b> Mosaic Plot</a></li>
<li class="chapter" data-level="5.2.3" data-path="results.html"><a href="results.html#stacked-barplot"><i class="fa fa-check"></i><b>5.2.3</b> Stacked Barplot</a></li>
<li class="chapter" data-level="5.2.4" data-path="results.html"><a href="results.html#alluvial-diagram"><i class="fa fa-check"></i><b>5.2.4</b> Alluvial Diagram</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="results.html"><a href="results.html#deep-dive-into-reactions-of-politicians"><i class="fa fa-check"></i><b>5.3</b> Deep dive into reactions of politicians:</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="results.html"><a href="results.html#transition-of-sentiments-for-different-political-parties"><i class="fa fa-check"></i><b>5.3.1</b> Transition of Sentiments for Different Political Parties</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="interactive-component.html"><a href="interactive-component.html"><i class="fa fa-check"></i><b>6</b> Interactive component</a></li>
<li class="chapter" data-level="7" data-path="conclusion.html"><a href="conclusion.html"><i class="fa fa-check"></i><b>7</b> Conclusion</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Twitter Sentiment Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="missing-values" class="section level1" number="4">
<h1><span class="header-section-number">Chapter 4</span> Missing values</h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="missing-values.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="missing-values.html#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb1-3"><a href="missing-values.html#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggnewscale)</span>
<span id="cb1-4"><a href="missing-values.html#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rtweet)</span>
<span id="cb1-5"><a href="missing-values.html#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sjmisc)</span>
<span id="cb1-6"><a href="missing-values.html#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span></code></pre></div>
<p>Here is the missing value plot function we defined in Problem Set 4.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="missing-values.html#cb2-1" aria-hidden="true" tabindex="-1"></a>plot_missing <span class="ot">&lt;-</span> <span class="cf">function</span>(data, percent) {</span>
<span id="cb2-2"><a href="missing-values.html#cb2-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colnames</span>(data) <span class="ot">&lt;-</span>  <span class="fu">abbreviate</span>(<span class="fu">colnames</span>(data), <span class="at">minlength =</span> <span class="dv">3</span>)</span>
<span id="cb2-3"><a href="missing-values.html#cb2-3" aria-hidden="true" tabindex="-1"></a>    mp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">is.na</span>(data)) <span class="sc">%&gt;%</span></span>
<span id="cb2-4"><a href="missing-values.html#cb2-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">group_by_all</span>() <span class="sc">%&gt;%</span></span>
<span id="cb2-5"><a href="missing-values.html#cb2-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">count</span>(<span class="at">name =</span> <span class="st">&quot;count&quot;</span>, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-6"><a href="missing-values.html#cb2-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ungroup</span>()</span>
<span id="cb2-7"><a href="missing-values.html#cb2-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-8"><a href="missing-values.html#cb2-8" aria-hidden="true" tabindex="-1"></a>    missing_patterns <span class="ot">&lt;-</span> mp <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(mp)<span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb2-9"><a href="missing-values.html#cb2-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-10"><a href="missing-values.html#cb2-10" aria-hidden="true" tabindex="-1"></a>    sorted_num_missing <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">colSums</span>(<span class="fu">is.na</span>(data)), <span class="at">decreasing =</span> <span class="cn">TRUE</span>, <span class="at">index.return=</span><span class="cn">TRUE</span>)</span>
<span id="cb2-11"><a href="missing-values.html#cb2-11" aria-hidden="true" tabindex="-1"></a>    level <span class="ot">&lt;-</span>  <span class="fu">colnames</span>(missing_patterns[sorted_num_missing<span class="sc">$</span>ix])</span>
<span id="cb2-12"><a href="missing-values.html#cb2-12" aria-hidden="true" tabindex="-1"></a>    mid <span class="ot">&lt;-</span> level[<span class="fu">ceiling</span>(<span class="fu">length</span>(level)<span class="sc">/</span><span class="dv">2</span>)] <span class="co"># get name of var located at the center of graph to put &quot;complete case&quot;</span></span>
<span id="cb2-13"><a href="missing-values.html#cb2-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-14"><a href="missing-values.html#cb2-14" aria-hidden="true" tabindex="-1"></a>    tidy_missing_patterns <span class="ot">&lt;-</span> </span>
<span id="cb2-15"><a href="missing-values.html#cb2-15" aria-hidden="true" tabindex="-1"></a>      missing_patterns <span class="sc">%&gt;%</span></span>
<span id="cb2-16"><a href="missing-values.html#cb2-16" aria-hidden="true" tabindex="-1"></a>      <span class="fu">add_column</span>(<span class="at">complete =</span> <span class="fu">if_else</span>(<span class="fu">rowSums</span>(missing_patterns)<span class="sc">==</span><span class="dv">0</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb2-17"><a href="missing-values.html#cb2-17" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rownames_to_column</span>(<span class="st">&quot;id&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-18"><a href="missing-values.html#cb2-18" aria-hidden="true" tabindex="-1"></a>      <span class="fu">gather</span>(key, value, <span class="fu">c</span>(<span class="sc">-</span>id,<span class="sc">-</span>complete))</span>
<span id="cb2-19"><a href="missing-values.html#cb2-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-20"><a href="missing-values.html#cb2-20" aria-hidden="true" tabindex="-1"></a>    df <span class="ot">&lt;-</span> sorted_num_missing<span class="sc">$</span>x</span>
<span id="cb2-21"><a href="missing-values.html#cb2-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-22"><a href="missing-values.html#cb2-22" aria-hidden="true" tabindex="-1"></a>    top_count <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb2-23"><a href="missing-values.html#cb2-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">name=</span><span class="fu">names</span>(df) ,  </span>
<span id="cb2-24"><a href="missing-values.html#cb2-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">value=</span>df)</span>
<span id="cb2-25"><a href="missing-values.html#cb2-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-26"><a href="missing-values.html#cb2-26" aria-hidden="true" tabindex="-1"></a>    top_percent <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb2-27"><a href="missing-values.html#cb2-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">name=</span><span class="fu">names</span>(df) ,  </span>
<span id="cb2-28"><a href="missing-values.html#cb2-28" aria-hidden="true" tabindex="-1"></a>      <span class="at">value=</span>df<span class="sc">*</span><span class="dv">100</span><span class="sc">/</span><span class="fu">nrow</span>(data))</span>
<span id="cb2-29"><a href="missing-values.html#cb2-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-30"><a href="missing-values.html#cb2-30" aria-hidden="true" tabindex="-1"></a>    cmp <span class="ot">&lt;-</span> missing_patterns <span class="sc">%&gt;%</span></span>
<span id="cb2-31"><a href="missing-values.html#cb2-31" aria-hidden="true" tabindex="-1"></a>      <span class="fu">add_column</span>(<span class="at">complete =</span> <span class="fu">if_else</span>(<span class="fu">rowSums</span>(missing_patterns)<span class="sc">==</span><span class="dv">0</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>))</span>
<span id="cb2-32"><a href="missing-values.html#cb2-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-33"><a href="missing-values.html#cb2-33" aria-hidden="true" tabindex="-1"></a>    side_count <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb2-34"><a href="missing-values.html#cb2-34" aria-hidden="true" tabindex="-1"></a>      <span class="at">name=</span><span class="fu">as.factor</span>(<span class="fu">seq.int</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(missing_patterns))),</span>
<span id="cb2-35"><a href="missing-values.html#cb2-35" aria-hidden="true" tabindex="-1"></a>      <span class="at">value=</span>mp<span class="sc">$</span>count,</span>
<span id="cb2-36"><a href="missing-values.html#cb2-36" aria-hidden="true" tabindex="-1"></a>      <span class="at">complete=</span>cmp<span class="sc">$</span>complete</span>
<span id="cb2-37"><a href="missing-values.html#cb2-37" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb2-38"><a href="missing-values.html#cb2-38" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-39"><a href="missing-values.html#cb2-39" aria-hidden="true" tabindex="-1"></a>    side_percent <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb2-40"><a href="missing-values.html#cb2-40" aria-hidden="true" tabindex="-1"></a>      <span class="at">name=</span><span class="fu">as.factor</span>(<span class="fu">seq.int</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(missing_patterns))),</span>
<span id="cb2-41"><a href="missing-values.html#cb2-41" aria-hidden="true" tabindex="-1"></a>      <span class="at">value=</span>mp<span class="sc">$</span>count<span class="sc">*</span><span class="dv">100</span><span class="sc">/</span><span class="fu">nrow</span>(data),</span>
<span id="cb2-42"><a href="missing-values.html#cb2-42" aria-hidden="true" tabindex="-1"></a>      <span class="at">complete=</span>cmp<span class="sc">$</span>complete</span>
<span id="cb2-43"><a href="missing-values.html#cb2-43" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb2-44"><a href="missing-values.html#cb2-44" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-45"><a href="missing-values.html#cb2-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (percent) {</span>
<span id="cb2-46"><a href="missing-values.html#cb2-46" aria-hidden="true" tabindex="-1"></a>      p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(top_percent, <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">fct_relevel</span>(name, level), <span class="at">y=</span>value)) <span class="sc">+</span> </span>
<span id="cb2-47"><a href="missing-values.html#cb2-47" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">alpha=</span><span class="fl">0.8</span>, <span class="at">fill=</span><span class="st">&quot;#97b7f3&quot;</span>) <span class="sc">+</span></span>
<span id="cb2-48"><a href="missing-values.html#cb2-48" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">100</span>) <span class="sc">+</span> </span>
<span id="cb2-49"><a href="missing-values.html#cb2-49" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ylab</span>(<span class="st">&quot;% rows missing:&quot;</span>) <span class="sc">+</span> </span>
<span id="cb2-50"><a href="missing-values.html#cb2-50" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme</span>(<span class="at">axis.title.x=</span><span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb2-51"><a href="missing-values.html#cb2-51" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ggtitle</span>(<span class="st">&quot;Missing value patterns&quot;</span>)</span>
<span id="cb2-52"><a href="missing-values.html#cb2-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-53"><a href="missing-values.html#cb2-53" aria-hidden="true" tabindex="-1"></a>      p2 <span class="ot">&lt;-</span><span class="fu">ggplot</span>(side_percent, <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">fct_rev</span>(name), <span class="at">y=</span>value, <span class="at">fill=</span>complete)) <span class="sc">+</span> </span>
<span id="cb2-54"><a href="missing-values.html#cb2-54" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">alpha=</span><span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb2-55"><a href="missing-values.html#cb2-55" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_fill_manual</span>(<span class="at">values =</span>  <span class="fu">c</span>(<span class="st">&quot;#97b7f3&quot;</span>, <span class="st">&quot;#6396ec&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb2-56"><a href="missing-values.html#cb2-56" aria-hidden="true" tabindex="-1"></a>        <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb2-57"><a href="missing-values.html#cb2-57" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ylab</span>(<span class="st">&quot;% row&quot;</span>) <span class="sc">+</span></span>
<span id="cb2-58"><a href="missing-values.html#cb2-58" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">100</span>) <span class="sc">+</span> </span>
<span id="cb2-59"><a href="missing-values.html#cb2-59" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme</span>(<span class="at">axis.title.y=</span><span class="fu">element_blank</span>()) <span class="sc">+</span> </span>
<span id="cb2-60"><a href="missing-values.html#cb2-60" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb2-61"><a href="missing-values.html#cb2-61" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb2-62"><a href="missing-values.html#cb2-62" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb2-63"><a href="missing-values.html#cb2-63" aria-hidden="true" tabindex="-1"></a>      p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(top_count, <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">fct_relevel</span>(name, level), <span class="at">y=</span>value)) <span class="sc">+</span> </span>
<span id="cb2-64"><a href="missing-values.html#cb2-64" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">alpha=</span><span class="fl">0.8</span>, <span class="at">fill=</span><span class="st">&quot;#97b7f3&quot;</span>) <span class="sc">+</span></span>
<span id="cb2-65"><a href="missing-values.html#cb2-65" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ylab</span>(<span class="st">&quot;num rows missing:&quot;</span>) <span class="sc">+</span> </span>
<span id="cb2-66"><a href="missing-values.html#cb2-66" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme</span>(<span class="at">axis.title.x=</span><span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb2-67"><a href="missing-values.html#cb2-67" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ggtitle</span>(<span class="st">&quot;Missing value patterns&quot;</span>)</span>
<span id="cb2-68"><a href="missing-values.html#cb2-68" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb2-69"><a href="missing-values.html#cb2-69" aria-hidden="true" tabindex="-1"></a>      p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(side_count, <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">fct_rev</span>(name), <span class="at">y=</span>value, <span class="at">fill=</span>complete)) <span class="sc">+</span> </span>
<span id="cb2-70"><a href="missing-values.html#cb2-70" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">alpha=</span><span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb2-71"><a href="missing-values.html#cb2-71" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_fill_manual</span>(<span class="at">values =</span>  <span class="fu">c</span>(<span class="st">&quot;#97b7f3&quot;</span>, <span class="st">&quot;#6396ec&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb2-72"><a href="missing-values.html#cb2-72" aria-hidden="true" tabindex="-1"></a>        <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb2-73"><a href="missing-values.html#cb2-73" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ylab</span>(<span class="st">&quot;row count&quot;</span>) <span class="sc">+</span> </span>
<span id="cb2-74"><a href="missing-values.html#cb2-74" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme</span>(<span class="at">axis.title.y=</span><span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb2-75"><a href="missing-values.html#cb2-75" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb2-76"><a href="missing-values.html#cb2-76" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb2-77"><a href="missing-values.html#cb2-77" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-78"><a href="missing-values.html#cb2-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-79"><a href="missing-values.html#cb2-79" aria-hidden="true" tabindex="-1"></a>    tidy_missing_patterns<span class="sc">$</span>id <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">as.integer</span>(tidy_missing_patterns<span class="sc">$</span>id))</span>
<span id="cb2-80"><a href="missing-values.html#cb2-80" aria-hidden="true" tabindex="-1"></a>    p3 <span class="ot">&lt;-</span><span class="fu">ggplot</span>(tidy_missing_patterns, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">fct_relevel</span>(key, level), <span class="at">y =</span> <span class="fu">fct_rev</span>(id), <span class="at">fill =</span> value)) <span class="sc">+</span></span>
<span id="cb2-81"><a href="missing-values.html#cb2-81" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="fu">aes</span>(<span class="at">alpha=</span>complete)) <span class="sc">+</span></span>
<span id="cb2-82"><a href="missing-values.html#cb2-82" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">ifelse</span>(complete <span class="sc">==</span> <span class="cn">TRUE</span> <span class="sc">&amp;</span> key<span class="sc">==</span>mid, <span class="st">&quot;complete cases&quot;</span>, <span class="st">&quot;&quot;</span>))) <span class="sc">+</span> </span>
<span id="cb2-83"><a href="missing-values.html#cb2-83" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_fill_manual</span>(<span class="at">values =</span>  <span class="fu">c</span>(<span class="st">&quot;#b3b3b3&quot;</span>, <span class="st">&quot;#9370da&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb2-84"><a href="missing-values.html#cb2-84" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_alpha_manual</span>(<span class="at">values =</span>  <span class="fu">c</span>(<span class="fl">0.7</span>, <span class="fl">1.0</span>)) <span class="sc">+</span> </span>
<span id="cb2-85"><a href="missing-values.html#cb2-85" aria-hidden="true" tabindex="-1"></a>      <span class="fu">xlab</span>(<span class="st">&quot;variable&quot;</span>) <span class="sc">+</span> </span>
<span id="cb2-86"><a href="missing-values.html#cb2-86" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ylab</span>(<span class="st">&quot;missing pattern&quot;</span>) <span class="sc">+</span></span>
<span id="cb2-87"><a href="missing-values.html#cb2-87" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb2-88"><a href="missing-values.html#cb2-88" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb2-89"><a href="missing-values.html#cb2-89" aria-hidden="true" tabindex="-1"></a>    p1 <span class="sc">+</span> <span class="fu">plot_spacer</span>() <span class="sc">+</span> p3 <span class="sc">+</span> p2 <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>), <span class="at">heights =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>), <span class="fu">c</span>(<span class="st">&#39;cm&#39;</span>,<span class="st">&#39;null&#39;</span>)))</span>
<span id="cb2-90"><a href="missing-values.html#cb2-90" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="missing-values.html#cb3-1" aria-hidden="true" tabindex="-1"></a>df_combined <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;./resources/data_combined_filtered_sentiment_old.csv&quot;</span>)</span></code></pre></div>
<p>Then we checked how many missing values each column has.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="missing-values.html#cb4-1" aria-hidden="true" tabindex="-1"></a>df_combined <span class="sc">%&gt;%</span> <span class="fu">summarise_all</span>(<span class="fu">funs</span>(<span class="fu">sum</span>(<span class="fu">is.na</span>(.))))</span></code></pre></div>
<pre><code>## # A tibble: 1 × 19
##   created_at screen_name  text retweet_count quote_count reply_count
##        &lt;int&gt;       &lt;int&gt; &lt;int&gt;         &lt;int&gt;       &lt;int&gt;       &lt;int&gt;
## 1          0           0    33             0       12451       12451
## # … with 13 more variables: followers_count &lt;int&gt;, group &lt;int&gt;, joy &lt;int&gt;,
## #   trust &lt;int&gt;, anticipation &lt;int&gt;, sadness &lt;int&gt;, fear &lt;int&gt;, anger &lt;int&gt;,
## #   surprise &lt;int&gt;, disgust &lt;int&gt;, positive &lt;int&gt;, negative &lt;int&gt;,
## #   sentiment_score &lt;int&gt;</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="missing-values.html#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_missing</span>(df_combined, <span class="at">percent =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="finalproj_files/figure-html/unnamed-chunk-8-1.png" width="960" /></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="missing-values.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_missing</span>(df_combined, <span class="at">percent =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="finalproj_files/figure-html/unnamed-chunk-8-2.png" width="960" /></p>
<p>It is hard to draw any significant conclusion from columns that have more than 90% of entries with missing values. Thus, we decided to remove all columns that have NA in more than 90% of entries. As a matter of fact, “quote_count” and “reply_count” columns have 100% of the entries with NA, so they will be removed from this filtering.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="missing-values.html#cb8-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_combined <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">which</span>(<span class="fu">colMeans</span>(<span class="fu">is.na</span>(.)) <span class="sc">&lt;=</span> <span class="fl">0.9</span>))</span></code></pre></div>
<p>Also, there are 33 rows that have NA for text, which is the tweet. We can’t perform any sentiment analysis on rows that have no tweet, so we are removing those 33 rows.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="missing-values.html#cb9-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">drop_na</span>(text)</span></code></pre></div>
<p>Also, we want to remove the rows that have NA for “positive” and “negative” sentiments. Having NA for those sentiments mean that the tweet doesn’t contain any information to calculate sentiment score, so we should remove those rows.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="missing-values.html#cb10-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df[<span class="sc">!</span><span class="fu">apply</span>(<span class="fu">is.na</span>(df[,<span class="fu">c</span>(<span class="st">&quot;positive&quot;</span>, <span class="st">&quot;negative&quot;</span>)]), <span class="dv">1</span>, all),]</span></code></pre></div>
<p>In addition, for sentiment columns - joy, trust, anticipation, sadness, fear, anger, surprise, disgust, positive, negative - we want to replace NAs with 0s because NA in those columns means that the tweet didn’t contain any word that pertains to those sentiments. Having 0s in place of NAs will ensure that all the sentiment columns have valid number entries, 0 meaning no count.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="missing-values.html#cb11-1" aria-hidden="true" tabindex="-1"></a>df[<span class="fu">c</span>(<span class="st">&quot;joy&quot;</span>, <span class="st">&quot;trust&quot;</span>, <span class="st">&quot;anticipation&quot;</span>, <span class="st">&quot;sadness&quot;</span>, <span class="st">&quot;fear&quot;</span>, <span class="st">&quot;anger&quot;</span>, <span class="st">&quot;surprise&quot;</span>, <span class="st">&quot;disgust&quot;</span>, <span class="st">&quot;positive&quot;</span>, <span class="st">&quot;negative&quot;</span>)][<span class="fu">is.na</span>(df[<span class="fu">c</span>(<span class="st">&quot;joy&quot;</span>, <span class="st">&quot;trust&quot;</span>, <span class="st">&quot;anticipation&quot;</span>, <span class="st">&quot;sadness&quot;</span>, <span class="st">&quot;fear&quot;</span>, <span class="st">&quot;anger&quot;</span>, <span class="st">&quot;surprise&quot;</span>, <span class="st">&quot;disgust&quot;</span>, <span class="st">&quot;positive&quot;</span>, <span class="st">&quot;negative&quot;</span>)])] <span class="ot">&lt;-</span> <span class="dv">0</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="missing-values.html#cb12-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">summarise_all</span>(<span class="fu">funs</span>(<span class="fu">sum</span>(<span class="fu">is.na</span>(.))))</span></code></pre></div>
<pre><code>## # A tibble: 1 × 17
##   created_at screen_name  text retweet_count followers_count group   joy trust
##        &lt;int&gt;       &lt;int&gt; &lt;int&gt;         &lt;int&gt;           &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
## 1          0           0     0             0               0     0     0     0
## # … with 9 more variables: anticipation &lt;int&gt;, sadness &lt;int&gt;, fear &lt;int&gt;,
## #   anger &lt;int&gt;, surprise &lt;int&gt;, disgust &lt;int&gt;, positive &lt;int&gt;, negative &lt;int&gt;,
## #   sentiment_score &lt;int&gt;</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="missing-values.html#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_missing</span>(df, <span class="at">percent =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="finalproj_files/figure-html/unnamed-chunk-14-1.png" width="960" /></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="missing-values.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_missing</span>(df, <span class="at">percent =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="finalproj_files/figure-html/unnamed-chunk-14-2.png" width="960" /></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="missing-values.html#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(df, <span class="st">&quot;./resources/data_combined_filtered_sentiment.csv&quot;</span>)</span></code></pre></div>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-transformation.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="results.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/twittersentimentanalyze/twittersentiment/edit/main/04-missing.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/twittersentimentanalyze/twittersentiment/blob/main/04-missing.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
