# Data sources

Our dataset consists of tweets data collected by rtweet Twitter API. We mainly collected tweets for four groups of people/organizations: politicians, medical associations, news media, and celebrities. For each group, we chose top 10 most-followed twitter accounts and extracted 10,000 most recent tweets of each user within time range 2020-03-12 23:00:56 ~ 2021-11-28 17:30:42. For the users that have less than 10,000 tweets during that time, all their tweets in the time range are collected.

All three of the team members contributed to collecting data. Alex ~~, Elin ~~, and Kevin found top 100 most-followed medical Twitter accounts. (Ref: https://emedcert.com/blog/top-healthcare-twitter-accounts-to-follow )

Main issue we faced when collecting data was that there was no API that allows us to find top x most-followed accounts for specific group of people/organizations. Thus, we had to manually look for twitter accounts listed in Twitter Statistics websites such as SocialBlade. For medical associations, we had to narrow down the top 100 most-followed accounts to top 10 using # of followers provided by get_timelines function in rtweet. 
Also, another issue is that for the top 10 politicians, the number of followers for 5 Republicans vs. the number of followers for 5 Democrats have a huge gap. Democrats have 4~10 times more followers than the Republicans, and this could result in one party's opinion influencing sentiment score more than the other. 

```{r, include=FALSE}
knitr::opts_chunk$set(echo= TRUE, warning = FALSE, message = FALSE) 
```

```{r}
library(tidyverse)
library(patchwork)
library(ggnewscale)
library(rtweet)
library(sjmisc)
library(readr)
library(rtweet)
```

## Politicians
```{r eval=FALSE}
politicians <- c('BarackObama','JoeBiden','HillaryClinton','KamalaHarris','AOC','Mike_Pence','tedcruz','marcorubio','randpaul','MittRomney')

df_politicians <- data.frame()
for (name in politicians) {
  new <- get_timelines(name,
                          n = 10000,
                          since_id = '1238238576141352965', # 2020-03-12 23:00:56
                          max_id = '1465010274029785092') # 2021-11-28 17:30:42
  df_politicians <- rbind(new, df_politicians)
}
```

```{r eval=FALSE}
write_csv(df_politicians, "./resources/data_politicians.csv")
```


## Medical Associations
```{r eval=FALSE}
medical <- c('AANP_News', 'allnurses', 'AmerMedicalAssn', 'American_Heart', 'amjnurs', 'RedCross', 'mindofandre', 'picardonhealth', 'andrewspong', 'PublicHealth', 'Atul_Gawande', 'Berci', 'ahier', 'mobilehealth', 'TheNerdyNurse', 'Doctor_V', 'CMichaelGibson', 'CDCgov', 'CDCemergency', 'ClevelandClinic', 'chasedave', 'ePatientDave', 'drwalker_rph', 'healthblawg', 'dlschermd', 'MSF_USA', 'donaldhackett', 'giasison', 'mtnmd', 'DrKevinCampbell', 'orenfu', 'drsanjaygupta', 'drseisenberg', 'EricTopol', 'FierceHealth', 'GavinPrestonMD', 'gnayyar', 'drhubaevaluator', 'chimoose', '2healthguru', 'HarvardHealth', 'Health_Affairs', 'HealthITNews', 'HealthLeaders', 'HHSGov', 'HIMSS', 'hjluks', 'JAMA_current', 'healthythinker', 'JohnNosta', 'HopkinsMedicine', 'KHNews', 'kentbottles', 'kevinmd', 'DrLeanaWen', 'LeeAase', 'DrLindseyFitz', 'lisagualtieri', 'MandiBPro', 'matthewherper', 'MayoClinic', 'MDAndersonNews', 'medcitynews', 'MedEconomics', 'medpagetoday', 'medscape', 'drmikesevilla', 'modrnhealthcr', 'NeilFlochMD', 'NEJM', 'NPRhealth', 'NurseGroups', 'michellekatzmsn', 'Nurse_com', 'ANANursingWorld', 'nursingtimes', 'NYTHealth', 'Paul_Sonnier', 'physicianspract', 'Reuters_Health', 'ReviewNursing', 'RichDuszak', 'sarahkliff', 'Cascadia', 'StJude', 'StanfordMed', 'SusannahFox', 'Docweighsin', 'THCBstaff', 'TheLancet', 'vmontori', 'futuredocs', 'WSJhealth', 'WebMD', 'HealthcareWen', 'WeNurses', 'WHO', 'ZDoggMD')

temp <- data.frame()
for (name in medical){
  line <- get_timelines(name, n=1)
  temp <- rbind(line, temp)
}
```

```{r eval=FALSE}
sorted_medical_accounts <- temp %>% arrange(desc(followers_count)) 
medical <- sorted_medical_accounts$screen_name[1:10] # top 10 medical account

df_medical <- data.frame()
for (name in medical) {
  new <- get_timelines(name, 
                          n = 10000,
                          since_id = '1238238576141352965', # 2020-03-12 23:00:56
                          max_id = '1465010274029785092') # 2021-11-28 17:30:42	  
  df_medical <- rbind(new, df_medical)
}
```

```{r eval=FALSE}
write_csv(df_medical, "./resources/data_medical.csv")
```

## News Media
```{r eval=FALSE}
newsmedia <- c("cnnbrk", "nytimes", "wsj", "time", "abc", "washingtonpost", "ap", "huffpost", "guardian","foxnews")

df_newsmedia <- data.frame()
for (name in newsmedia) {
  new <- get_timelines(name, 
                          n = 10000,
                          since_id = '1238238576141352965', # 2020-03-12 23:00:56
                          max_id = '1465010274029785092') # 2021-11-28 17:30:42	  
  df_newsmedia <- rbind(new, df_newsmedia)
}
```

```{r eval=FALSE}
write_csv(df_newsmedia, "./resources/data_newsmedia.csv")
```

```{r eval=FALSE}
output <- c()
cleaned_text <- clean_tweets(df_newsmedia$text)
for (words in str_split(cleaned_text, " ")) {
  f <- if_else(any(words %in% tag), 1, 0)
  output <- append(output, f)
}

df_newsmedia$output <- output

df_newsmedia %>% filter(output == 1) -> filtered_df_newsmedia
```

## Celebrities
```{r eval=FALSE}
celebrities <- c("justinbieber","katyperry","rihanna","taylorswift13","arianagrande","ladygaga","TheEllenShow","KimKardashian","selenagomez","elonmusk")

df_celebrities <- data.frame()
for (name in celebrities) {
  new <- get_timelines(name, 
                          n = 10000,
                          since_id = '1238238576141352965', # 2020-03-12 23:00:56
                          max_id = '1465010274029785092') # 2021-11-28 17:30:42	  
  df_celebrities <- rbind(new, df_celebrities)
}
```

```{r eval=FALSE}
write_csv(df_celebrities, "./resources/data_celebrities.csv")
```
